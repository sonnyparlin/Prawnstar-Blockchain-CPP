<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Prawnstar Blockchain: ProofOfStake Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Prawnstar Blockchain
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="class_proof_of_stake-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ProofOfStake Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_proof_of_stake_8hpp_source.html">ProofOfStake.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a48be725a43b54e7e5e7acdeb50e5f275"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#a48be725a43b54e7e5e7acdeb50e5f275">ProofOfStake</a> (<a class="el" href="class_node.html">Node</a> *node)</td></tr>
<tr class="separator:a48be725a43b54e7e5e7acdeb50e5f275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7450b27f25066f7d58ed1457a28c5882"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#a7450b27f25066f7d58ed1457a28c5882">update</a> (const std::string &amp;, double stake)</td></tr>
<tr class="separator:a7450b27f25066f7d58ed1457a28c5882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaae5f1b8f8fca2a4715d26797a9d54af"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#aaae5f1b8f8fca2a4715d26797a9d54af">getStake</a> (const std::string &amp;)</td></tr>
<tr class="separator:aaae5f1b8f8fca2a4715d26797a9d54af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab40dabdee4512c01652a90fa0286c536"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="class_lot.html">Lot</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#ab40dabdee4512c01652a90fa0286c536">validatorLots</a> (const std::string &amp;seed)</td></tr>
<tr class="separator:ab40dabdee4512c01652a90fa0286c536"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab26da4a7bdcd9a1cd41a8f712f0bfcaf"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#ab26da4a7bdcd9a1cd41a8f712f0bfcaf">forger</a> (const std::string &amp;)</td></tr>
<tr class="separator:ab26da4a7bdcd9a1cd41a8f712f0bfcaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1c30dfae8c37a570cb912e36c0d54da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#aa1c30dfae8c37a570cb912e36c0d54da">setGenesisNodeStake</a> (const std::string &amp;)</td></tr>
<tr class="separator:aa1c30dfae8c37a570cb912e36c0d54da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ac16b760356071b95f058ade60600520d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_lot.html">Lot</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#ac16b760356071b95f058ade60600520d">winnerLot</a> (const std::vector&lt; <a class="el" href="class_lot.html">Lot</a> &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="separator:ac16b760356071b95f058ade60600520d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c085fef5384a0389935a6eed49979e4"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#a7c085fef5384a0389935a6eed49979e4">fnv1a</a> (const std::string &amp;text)</td></tr>
<tr class="separator:a7c085fef5384a0389935a6eed49979e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ea36e15943830944d455cb700d4106c"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#a3ea36e15943830944d455cb700d4106c">lcg_rand</a> (uint32_t *state)</td></tr>
<tr class="separator:a3ea36e15943830944d455cb700d4106c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a3d8e09fd4ecaa0bbf68602fe57e5a567"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#a3d8e09fd4ecaa0bbf68602fe57e5a567">stakers</a></td></tr>
<tr class="separator:a3d8e09fd4ecaa0bbf68602fe57e5a567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a231de78a8b3da7b17ec779720b148358"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_proof_of_stake.html#a231de78a8b3da7b17ec779720b148358">posMutex</a></td></tr>
<tr class="separator:a231de78a8b3da7b17ec779720b148358"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Proof of Stake, our blockchain's consensus algorithm. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a48be725a43b54e7e5e7acdeb50e5f275" name="a48be725a43b54e7e5e7acdeb50e5f275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48be725a43b54e7e5e7acdeb50e5f275">&#9670;&nbsp;</a></span>ProofOfStake()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ProofOfStake::ProofOfStake </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_node.html">Node</a> *&#160;</td>
          <td class="paramname"><em>passedInNode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">passedInNode</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Constructor for the <a class="el" href="class_proof_of_stake.html">ProofOfStake</a> class, starts genesis node sets up this node's wallet as a staker so the system will run. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7c085fef5384a0389935a6eed49979e4" name="a7c085fef5384a0389935a6eed49979e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c085fef5384a0389935a6eed49979e4">&#9670;&nbsp;</a></span>fnv1a()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ProofOfStake::fnv1a </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">text</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint32_t</dd></dl>
<p>Hashing function that is platform independant. </p>

</div>
</div>
<a id="ab26da4a7bdcd9a1cd41a8f712f0bfcaf" name="ab26da4a7bdcd9a1cd41a8f712f0bfcaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab26da4a7bdcd9a1cd41a8f712f0bfcaf">&#9670;&nbsp;</a></span>forger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ProofOfStake::forger </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>lastBlockHash</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lastBlockHash</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::string</dd></dl>
<p>forger gets a list of all the validator Lots and selects one at random. The number of validator lots corresponds to the amount of tokens that are staked by a staker/validator. </p>

</div>
</div>
<a id="aaae5f1b8f8fca2a4715d26797a9d54af" name="aaae5f1b8f8fca2a4715d26797a9d54af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaae5f1b8f8fca2a4715d26797a9d54af">&#9670;&nbsp;</a></span>getStake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProofOfStake::getStake </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>publicKeyString</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">publicKeyString</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double</dd></dl>
<p>Get the stake of the user with publicKeyString </p>

</div>
</div>
<a id="a3ea36e15943830944d455cb700d4106c" name="a3ea36e15943830944d455cb700d4106c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ea36e15943830944d455cb700d4106c">&#9670;&nbsp;</a></span>lcg_rand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ProofOfStake::lcg_rand </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint32_t</dd></dl>
<p>A linear congruential generator (LCG) is an algorithm that yields a sequence of pseudo-randomized numbers calculated with a discontinuous piecewise linear equation. The method represents one of the oldest and best-known pseudorandom number generator algorithms. </p>

</div>
</div>
<a id="aa1c30dfae8c37a570cb912e36c0d54da" name="aa1c30dfae8c37a570cb912e36c0d54da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1c30dfae8c37a570cb912e36c0d54da">&#9670;&nbsp;</a></span>setGenesisNodeStake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProofOfStake::setGenesisNodeStake </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>genesisPublicKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">genesisPublicKey</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Set up the genesis node stake so the system will run before real stakers show up. </p>

</div>
</div>
<a id="a7450b27f25066f7d58ed1457a28c5882" name="a7450b27f25066f7d58ed1457a28c5882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7450b27f25066f7d58ed1457a28c5882">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProofOfStake::update </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>publicKeyString</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stake</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">publicKeyString</td><td></td></tr>
    <tr><td class="paramname">stake</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Update the stake of the user with publicKeyString to the new amount specified in stake. </p>

</div>
</div>
<a id="ab40dabdee4512c01652a90fa0286c536" name="ab40dabdee4512c01652a90fa0286c536"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab40dabdee4512c01652a90fa0286c536">&#9670;&nbsp;</a></span>validatorLots()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="class_lot.html">Lot</a> &gt; ProofOfStake::validatorLots </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seed</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::vector&lt;Lot&gt;</dd></dl>
<p>Create lottery tickets for the stakers to be chosen at random to decide who the next forger is. The number of lottery tickets for each staker corresponds to the amount of tokens they are staking. </p>

</div>
</div>
<a id="ac16b760356071b95f058ade60600520d" name="ac16b760356071b95f058ade60600520d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac16b760356071b95f058ade60600520d">&#9670;&nbsp;</a></span>winnerLot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_lot.html">Lot</a> ProofOfStake::winnerLot </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_lot.html">Lot</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>lots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lots</td><td></td></tr>
    <tr><td class="paramname">seed</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="class_lot.html">Lot</a></dd></dl>
<p>Chooses a winner for the forger lottery based on the random selection of Lots. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a231de78a8b3da7b17ec779720b148358" name="a231de78a8b3da7b17ec779720b148358"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a231de78a8b3da7b17ec779720b148358">&#9670;&nbsp;</a></span>posMutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex ProofOfStake::posMutex</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >mutext for guarding shared data (stakers list) </p>

</div>
</div>
<a id="a3d8e09fd4ecaa0bbf68602fe57e5a567" name="a3d8e09fd4ecaa0bbf68602fe57e5a567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d8e09fd4ecaa0bbf68602fe57e5a567">&#9670;&nbsp;</a></span>stakers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;std::string, double&gt; ProofOfStake::stakers</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >list of stakers </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="_proof_of_stake_8hpp_source.html">ProofOfStake.hpp</a></li>
<li>ProofOfStake.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
